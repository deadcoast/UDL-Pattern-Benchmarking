
<!DOCTYPE html>
<html>
<head>
    <title>Real-time Metrics Dashboard</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link rel="stylesheet" href="static/style.css">
</head>
<body>
    <div class="container">
        <h1>Real-time Metrics Dashboard</h1>
        
        <div class="controls">
            <button onclick="startRealTimeUpdates()">Start Real-time</button>
            <button onclick="stopRealTimeUpdates()">Stop</button>
            <label>
                Update Interval: <input type="range" id="updateInterval" min="100" max="5000" value="1000" onchange="updateInterval()"> ms
            </label>
        </div>
        
        <div class="metric-displays">
            
            <div class="metric-display">
                <div class="metric-name">consistency</div>
                <div class="metric-value" id="metric-consistency">0.790</div>
            </div>
            
            <div class="metric-display">
                <div class="metric-name">completeness</div>
                <div class="metric-value" id="metric-completeness">0.456</div>
            </div>
            
            <div class="metric-display">
                <div class="metric-name">expressiveness</div>
                <div class="metric-value" id="metric-expressiveness">0.184</div>
            </div>
            
            <div class="metric-display">
                <div class="metric-name">structural_coherence</div>
                <div class="metric-value" id="metric-structural_coherence">0.462</div>
            </div>
            
        </div>
        
        <div class="visualization-panel">
            <h3>Metric Evolution</h3>
            <svg id="metrics-chart" width="800" height="400"></svg>
        </div>
        
        <div class="visualization-panel">
            <h3>Metric Correlations</h3>
            <svg id="correlation-matrix" width="400" height="400"></svg>
        </div>
    </div>

    <script>
        const metricHistory = {"consistency": [0.5672538996192397, 0.5848458092884551, 0.7010242441502772, 0.6214491569294387, 0.6436754011662709, 0.6269215749480959, 0.6421145819783973, 0.5102615108995152, 0.6693088082028339, 0.578687646132717, 0.578664485477193, 0.6226494240366646, 0.5456622494036605, 0.5743696518933223, 0.6278823051942733, 0.6091588662914974, 0.6841578694469089, 0.6086788882440366, 0.6489674920008885, 0.5446600548467077, 0.5243262194533326, 0.624462107999579, 0.5223223575718058, 0.6637296396905339, 0.6697767708587331, 0.7456100727824102, 0.5987792926106221, 0.6161548764716314, 0.6031498234705818, 0.6826890036556325, 0.6343566862734515, 0.6847444004407677, 0.673541335243225, 0.5463179834222327, 0.6076546248217242, 0.6077802879611227, 0.7756088329444988, 0.7057817142967071, 0.6145516482952404, 0.710342596933142, 0.6826256113327113, 0.7250924087577287, 0.6213011240314128, 0.6841285634351514, 0.684977748882227, 0.6504093715040269, 0.7027486384522339, 0.6709584817681016, 0.6889641312850541, 0.6774361716493338, 0.6821488662019399, 0.6423697627150735, 0.6753180265283452, 0.5867729483783023, 0.5885162349490841, 0.6124389682417574, 0.6078410531072852, 0.6432232486917988, 0.708455821372461, 0.783201763972255, 0.7186879708473922, 0.680540156203257, 0.6443835143798857, 0.6683033581261392, 0.7578622357813057, 0.6729889748803156, 0.7069894131162081, 0.7076829465325905, 0.6384761638943317, 0.6991845994312543, 0.7409056366145447, 0.6538386622871978, 0.7320012937552827, 0.7959215828452091, 0.6890925608959444, 0.6834666858864582, 0.667918717696434, 0.6662068722594288, 0.7068262216344632, 0.8682766801597352, 0.745946669282903, 0.8385262154545409, 0.7696788752384573, 0.7220943080812593, 0.754200074086702, 0.706503249450919, 0.7556863390809522, 0.7274124281543116, 0.8462440720835863, 0.805234353494801, 0.7743558226712599, 0.7922830391432861, 0.7582082398996782, 0.7288876019055829, 0.7910161112962102, 0.720043976682024, 0.7265481136055072, 0.8658324315210179, 0.8017122782587923, 0.7899692844403875], "completeness": [0.5598900776832783, 0.521144411267495, 0.5383212226475796, 0.5723641083023905, 0.5606250130657127, 0.571066378790455, 0.5270871570779012, 0.5289763041544684, 0.6140741289771554, 0.5641616415636544, 0.5337622504423821, 0.5587716964105639, 0.53245134159695, 0.5796038588949636, 0.4700479435757787, 0.5481624374388759, 0.5293244538135609, 0.5657176340889776, 0.488927286884439, 0.5582533265977434, 0.5927222988418581, 0.5917753092919299, 0.5746097407151042, 0.4777730745573135, 0.5360260062789648, 0.5483891071187255, 0.6363202374237991, 0.7015502509427544, 0.5396525395950081, 0.6054001210435701, 0.4564967338424019, 0.5393468513628178, 0.5624596592065895, 0.520191782441367, 0.6067591830798656, 0.5645952683997766, 0.5421095034848568, 0.49803185177568454, 0.4908063104645369, 0.5434442811837498, 0.5615797017595349, 0.5607228851045165, 0.5557303779089175, 0.5175579496482198, 0.5455496222361144, 0.519531001011326, 0.418637438908638, 0.4808253270486448, 0.4631748974111751, 0.5533955869648968, 0.4519530881247268, 0.4930421115180966, 0.5313607422831572, 0.43678466258078447, 0.5557985623705453, 0.4856707395951173, 0.38164381641463113, 0.4924254101946953, 0.43209354301592423, 0.48717542375511524, 0.4642777175277935, 0.48422792960657735, 0.5398976813876861, 0.508175240568181, 0.5675322977054599, 0.4548527545679264, 0.5387905491447147, 0.5055270817159552, 0.48989125794034366, 0.5024261721690766, 0.5116810931630081, 0.6314133824299482, 0.45395266795909167, 0.4437506324084184, 0.4871491093741444, 0.44621310707298967, 0.3213948605066168, 0.46052015098596955, 0.43146504441923, 0.5160049346705287, 0.5003363152510282, 0.48744436339172936, 0.4793700875635976, 0.5756988864555117, 0.40640342212505637, 0.4521945580073891, 0.5501159017956228, 0.4121968273975305, 0.4924191490048445, 0.5286291541069186, 0.49848316817300353, 0.3965781391133071, 0.5634737364435854, 0.4120733021843587, 0.49479799619750164, 0.540750531299777, 0.5082049992830903, 0.45680208028616376, 0.4321766781201202, 0.45554705262017325], "expressiveness": [0.34485690657377016, 0.40975349895324314, 0.4101907547997166, 0.38920936255461575, 0.29706103386318605, 0.38191849871807104, 0.3512773426145342, 0.37561431498478903, 0.37980848360796593, 0.3350697647314174, 0.3711885649009601, 0.3873011774684929, 0.4037693369161128, 0.46965185466097853, 0.34711672132155125, 0.3081593676994211, 0.46834486618870297, 0.35356166659091703, 0.3022866167067939, 0.36539490314160084, 0.3157465526563081, 0.35751696582094816, 0.3407657913490359, 0.39240978347831795, 0.28643420775621997, 0.34457295776474284, 0.3174475573369866, 0.2926753229578646, 0.4173937840839118, 0.30517458791508195, 0.3506740812231118, 0.21521759173394914, 0.2859469826694052, 0.3173636599445306, 0.2977832085685333, 0.28396859830575427, 0.3554813234839956, 0.3984284122965142, 0.40536291238779876, 0.24426640576553932, 0.31806158100480536, 0.24303039194444948, 0.3718798521090493, 0.3892492506803616, 0.3381889495818201, 0.31653585699685555, 0.30604512335712236, 0.3226097166386437, 0.28462496339549853, 0.31484372621263634, 0.2994736019310307, 0.3267209343983659, 0.2817601494227826, 0.29158138798828737, 0.33093705132883566, 0.2296478530870073, 0.18088201541072546, 0.34648986962247424, 0.21435746125578362, 0.3365807967196906, 0.30127398912920167, 0.2729768335541688, 0.23890628504098596, 0.28000909931019174, 0.2562355877609687, 0.3654743179633532, 0.3171457672461821, 0.2098871577704313, 0.33025683184411087, 0.23113908332788696, 0.3873319113355955, 0.26287018670467516, 0.21678893175836744, 0.29604119564652864, 0.246234506298655, 0.32570986930313567, 0.2532864994201508, 0.3106779632247964, 0.31203831491083855, 0.19373122167347182, 0.3369369931404004, 0.2393447702363577, 0.27970510503249446, 0.31115185244783544, 0.25424574460545046, 0.21500424368909807, 0.26419535528489807, 0.24739538024650098, 0.26262094984516543, 0.2835443683797543, 0.17886633490005366, 0.28988306620020277, 0.19944438252031188, 0.1703868383390461, 0.25670368455823817, 0.28908525592931916, 0.19864580264580584, 0.1968154938292045, 0.1974011517575223, 0.184146407432568], "structural_coherence": [0.6452900508007677, 0.5158808639723933, 0.573140069791714, 0.6849342021898499, 0.5301607227800735, 0.7179987537401484, 0.6839914151688951, 0.6218078814887997, 0.5547055359464222, 0.5731745128303566, 0.5484062381177914, 0.6028961917415253, 0.6148890654709112, 0.5963335423043706, 0.49386225415673723, 0.5878537514999238, 0.5256684466002662, 0.695737451349232, 0.6171606220176779, 0.6653008885059072, 0.6016223494697391, 0.6688818947885413, 0.6215302425253141, 0.5794066507294015, 0.6308718120552765, 0.5861339013973628, 0.585364177267547, 0.5772084514620772, 0.5985415955612374, 0.5331159984693445, 0.5190736207194333, 0.6193067839569235, 0.6554061416941855, 0.6191982010976803, 0.5902466516555441, 0.6208127326929911, 0.5445491773203448, 0.5147926465230875, 0.5128734764261692, 0.564507951266023, 0.6144898121007277, 0.5058351374283552, 0.5559143088519467, 0.6311156851758115, 0.5301922006314251, 0.6537184385389699, 0.5272141914342652, 0.605541518609246, 0.5046954307613185, 0.5740616696485239, 0.5123515285209809, 0.5418368411704041, 0.6285997432452307, 0.46527887152827696, 0.6283225128678445, 0.4600022051089596, 0.5108934548660649, 0.5099244738782444, 0.5703646509966055, 0.5217857556433239, 0.5050177009191594, 0.5349941541754876, 0.5096640409161762, 0.5961182215221318, 0.5372559280080419, 0.6024111838020663, 0.5650800224644303, 0.5569827325385932, 0.6458755617339956, 0.5137115947910048, 0.5556749279848741, 0.5265643400458324, 0.6129551977725977, 0.5848634594619618, 0.5482912054108412, 0.5074474766330197, 0.5423772462958389, 0.5024162538757623, 0.5767401509564842, 0.5468526429880216, 0.5739537349509735, 0.5244780282471134, 0.5121743014738318, 0.5496925277280188, 0.5236015522043813, 0.48944498252713364, 0.46175038575019145, 0.5272496290544622, 0.49223337068452105, 0.5291360754234874, 0.5293798421956664, 0.5402033696750341, 0.47422355568500596, 0.50492841528566, 0.5504001300006636, 0.4737283568013477, 0.4698066593352468, 0.5307652190635903, 0.5197025559320362, 0.4623054228108413]};
        let realTimeInterval;
        let isRealTime = false;
        
        function initializeDashboard() {
            setupMetricsChart();
            setupCorrelationMatrix();
            updateVisualizations();
        }
        
        function setupMetricsChart() {
            const svg = d3.select("#metrics-chart");
            const width = 800;
            const height = 400;
            const margin = { top: 20, right: 80, bottom: 30, left: 50 };
            
            svg.selectAll("*").remove();
            
            const xScale = d3.scaleLinear()
                .domain([0, Math.max(...Object.values(metricHistory).map(arr => arr.length)) - 1])
                .range([margin.left, width - margin.right]);
            
            const yScale = d3.scaleLinear()
                .domain([0, 1])
                .range([height - margin.bottom, margin.top]);
            
            // Add axes
            svg.append("g")
                .attr("transform", `translate(0,${height - margin.bottom})`)
                .call(d3.axisBottom(xScale));
            
            svg.append("g")
                .attr("transform", `translate(${margin.left},0)`)
                .call(d3.axisLeft(yScale));
            
            // Add lines for each metric
            const colors = d3.schemeCategory10;
            const line = d3.line()
                .x((d, i) => xScale(i))
                .y(d => yScale(d));
            
            Object.keys(metricHistory).forEach((metric, i) => {
                svg.append("path")
                    .datum(metricHistory[metric])
                    .attr("class", `metric-line metric-${metric}`)
                    .attr("fill", "none")
                    .attr("stroke", colors[i % colors.length])
                    .attr("stroke-width", 2)
                    .attr("d", line);
                
                // Add legend
                svg.append("text")
                    .attr("x", width - margin.right + 10)
                    .attr("y", margin.top + i * 20)
                    .attr("fill", colors[i % colors.length])
                    .text(metric);
            });
        }
        
        function setupCorrelationMatrix() {
            const svg = d3.select("#correlation-matrix");
            const size = 400;
            const margin = 40;
            
            svg.selectAll("*").remove();
            
            const metrics = Object.keys(metricHistory);
            const n = metrics.length;
            const cellSize = (size - 2 * margin) / n;
            
            // Compute correlation matrix
            const correlations = [];
            for (let i = 0; i < n; i++) {
                correlations[i] = [];
                for (let j = 0; j < n; j++) {
                    correlations[i][j] = computeCorrelation(
                        metricHistory[metrics[i]], 
                        metricHistory[metrics[j]]
                    );
                }
            }
            
            // Create color scale
            const colorScale = d3.scaleSequential(d3.interpolateRdBu)
                .domain([-1, 1]);
            
            // Add cells
            for (let i = 0; i < n; i++) {
                for (let j = 0; j < n; j++) {
                    svg.append("rect")
                        .attr("x", margin + j * cellSize)
                        .attr("y", margin + i * cellSize)
                        .attr("width", cellSize)
                        .attr("height", cellSize)
                        .attr("fill", colorScale(correlations[i][j]))
                        .attr("stroke", "white");
                    
                    svg.append("text")
                        .attr("x", margin + j * cellSize + cellSize/2)
                        .attr("y", margin + i * cellSize + cellSize/2)
                        .attr("text-anchor", "middle")
                        .attr("dominant-baseline", "middle")
                        .attr("fill", Math.abs(correlations[i][j]) > 0.5 ? "white" : "black")
                        .text(correlations[i][j].toFixed(2));
                }
            }
            
            // Add labels
            metrics.forEach((metric, i) => {
                svg.append("text")
                    .attr("x", margin + i * cellSize + cellSize/2)
                    .attr("y", margin - 10)
                    .attr("text-anchor", "middle")
                    .text(metric);
                
                svg.append("text")
                    .attr("x", margin - 10)
                    .attr("y", margin + i * cellSize + cellSize/2)
                    .attr("text-anchor", "end")
                    .attr("dominant-baseline", "middle")
                    .text(metric);
            });
        }
        
        function computeCorrelation(x, y) {
            const n = Math.min(x.length, y.length);
            if (n < 2) return 0;
            
            const meanX = x.slice(0, n).reduce((a, b) => a + b) / n;
            const meanY = y.slice(0, n).reduce((a, b) => a + b) / n;
            
            let numerator = 0;
            let sumXX = 0;
            let sumYY = 0;
            
            for (let i = 0; i < n; i++) {
                const dx = x[i] - meanX;
                const dy = y[i] - meanY;
                numerator += dx * dy;
                sumXX += dx * dx;
                sumYY += dy * dy;
            }
            
            const denominator = Math.sqrt(sumXX * sumYY);
            return denominator === 0 ? 0 : numerator / denominator;
        }
        
        function updateVisualizations() {
            // Update metric displays
            Object.keys(metricHistory).forEach(metric => {
                const latest = metricHistory[metric][metricHistory[metric].length - 1];
                const display = document.getElementById(`metric-${metric}`);
                if (display) {
                    display.textContent = latest.toFixed(3);
                }
            });
            
            // Redraw charts
            setupMetricsChart();
            setupCorrelationMatrix();
        }
        
        function startRealTimeUpdates() {
            if (!isRealTime) {
                isRealTime = true;
                const interval = document.getElementById("updateInterval").value;
                realTimeInterval = setInterval(() => {
                    // Simulate new data
                    Object.keys(metricHistory).forEach(metric => {
                        const lastValue = metricHistory[metric][metricHistory[metric].length - 1];
                        const newValue = Math.max(0, Math.min(1, lastValue + (Math.random() - 0.5) * 0.1));
                        metricHistory[metric].push(newValue);
                        
                        // Keep only last 100 points
                        if (metricHistory[metric].length > 100) {
                            metricHistory[metric].shift();
                        }
                    });
                    
                    updateVisualizations();
                }, parseInt(interval));
            }
        }
        
        function stopRealTimeUpdates() {
            isRealTime = false;
            clearInterval(realTimeInterval);
        }
        
        function updateInterval() {
            if (isRealTime) {
                stopRealTimeUpdates();
                startRealTimeUpdates();
            }
        }
        
        // Initialize on load
        initializeDashboard();
    </script>
</body>
</html>
        